<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="../style.css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<title>CTI: Theoretical Elements</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<div id="CTI: Theoretical Elements"><h1 id="CTI: Theoretical Elements" class="header"><a href="#CTI: Theoretical Elements">CTI: Theoretical Elements</a></h1></div>

<blockquote>
<p>
 How can we put in place effective countermeasures if we donÂ´t know which approaches and techniques the attacker will use? 

</p></blockquote>
</pre></code>
<p>
This problem can be addressed by using cyber threat intelligence. The Threat Intelligence process goal is to profile the adversary by making use of information that can be gathered from previous attacks, public and private repositories. 
</p>

<div id="CTI: Theoretical Elements-Information"><h2 id="Information" class="header"><a href="#CTI: Theoretical Elements-Information">Information</a></h2></div>

<p>
The intelligence process is the foundation of the CTI process, the very basic component of an intelligence process is the <em>information</em>. By the American Heritage Dictionary of the English Language, Information can be defined as
</p>

<blockquote>
<p>
 Any fact or set of facts, knowledge, news, or advice, whether communicated by others or obtained by personal study and investigation; any datum that reduces uncertainty about the state of any part of the world; intelligence; knowledge derived from reading, observation, or instruction.

</p></blockquote>
</pre></code>
<p>
In the cyber domain the information that we can collect comes from different sources, such as malware, monitoring tools, application logs, application servers, Operating System, and VPNs; information can be collected from external sources like public or private repositories or can be bought.
</p>

<p>
This huge set of heterogeneous information can be:
</p>

<ul>
<li>
Loosely structured, or

<li>
strictly structured.

<li>
Low level (technically speaking), or

<li>
high level, written in natural language. 

</ul>
<p>
Information in its raw state is difficult to use, and only by putting together all the traces left behind by an attacker would be possible to construct <em>part of</em> the history of the attack. When an analyst is capable of producing a credible hypothesis, actionable improvements can be made in the mitigation and defense capabilities of an organization.
</p>

<p>
An analyst need <span id="CTI: Theoretical Elements-Information-actionable intelligence"></span><strong id="actionable intelligence">actionable intelligence</strong> to produce a credible hypothesis, for this reason an intelligence process must be deployed to extract actionable intelligence from noise. 
</p>

<p>
From the firs huge set of <em>data</em> collected defined as <span id="CTI: Theoretical Elements-Information-noise"></span><strong id="noise">noise</strong>, the intelligence process extracts only the elements that are potentially relevant for the analyst. This first subset of information defined <span id="CTI: Theoretical Elements-Information-data"></span><strong id="data">data</strong>, data can be organized in different groups according to defining characteristics. A subset of data with a specific purpose is defined as <span id="CTI: Theoretical Elements-Information-intelligence"></span><strong id="intelligence">intelligence</strong>, intelligence has a specific strategic purpose but is made up of independent pieces. By <em>connecting the dots</em> <span id="CTI: Theoretical Elements-Information-actionable intelligence"></span><strong id="actionable intelligence">actionable intelligence</strong> is obtained, the adjective <em>actionable</em> highlights the fact that the distilled information can be used to understand how a successful attack happened and how to act to avoid a similar attack in the future.
</p>

<p>
The Intelligence Process is complex and iterative, and it is mostly a human centered activity. 
</p>

<div id="CTI: Theoretical Elements-Threat Intelligence Process"><h2 id="Threat Intelligence Process" class="header"><a href="#CTI: Theoretical Elements-Threat Intelligence Process">Threat Intelligence Process</a></h2></div>

<p>
The Threat Intelligence process is made up of five steps: Collection, Processing, Analysis and Production, Dissemination, Planning and Direction. 
</p>

<p>
By executing these five steps iteratively is possible to improve the next sub-sequences of the process. One approach consists on trying to identify the attackers, it does not mean to perform attribution, but to identify a specific source that uses specific techniques. Observing an attacker using different strategies and approaches can help us to understand its goals. By profiling an attacker is possible to pinpoint its motivations and key tactics.
</p>

<p>
In general terms the ideal goal of the analyst would be to reconstruct the <em>attacker's playbook</em>, or the instruction manual of the attack. A perfect reconstruction of the attacker's playbook would lead to setup the perfect mitigation for such attack, because every step of the attack killchain will be covered by a given defense mechanism.
</p>

<p>
Similarly to other process the intelligence process expands to different levels of the organization with different goals at each level.
</p>

<ul>
<li>
<span id="CTI: Theoretical Elements-Threat Intelligence Process-Tactical Level"></span><strong id="Tactical Level">Tactical Level</strong>. The goal is to provide technical decision and to provide an understanding of how mitigate threats and enable detection an mitigation actions. At these level actions must be performed quickly and have a direct impact on the security of the system.

<li>
<span id="CTI: Theoretical Elements-Threat Intelligence Process-Operational Level"></span><strong id="Operational Level">Operational Level</strong>. At this level decision taken will provide long term effects, by enabling the formulation of approaches, and the prioritization of activities.

<li>
<span id="CTI: Theoretical Elements-Threat Intelligence Process-Strategical Level"></span><strong id="Strategical Level">Strategical Level</strong>. At this level decision are taken by the board, and regards budget allocation and are correlated to the business impact of the process. 

</ul>
  
<p>
Note that at every level the time frame needed for decision making increases.
</p>

<div id="CTI: Theoretical Elements-How to make intelligence actionable"><h2 id="How to make intelligence actionable" class="header"><a href="#CTI: Theoretical Elements-How to make intelligence actionable">How to make intelligence actionable</a></h2></div>

<p>
The first assumption the analyst makes when distilling intelligence is that they are dealing with <span id="CTI: Theoretical Elements-How to make intelligence actionable-budget contrained attackers"></span><strong id="budget contrained attackers">budget contrained attackers</strong> or <span id="CTI: Theoretical Elements-How to make intelligence actionable-rational human attackers"></span><strong id="rational human attackers">rational human attackers</strong>; this assumption lead to the sub-sequent assumption that the attacker will find the best possible attack path that maximize its likelihood of success while minimizing the cost of the attack itself. The blue team strategy is to increase the overall cost of the attack and reduce its likelihood of success. 
</p>

<p>
The cost factor of an attack depends not only on a monetary aspect but also on the expertise, time and resources needed. Another assumption taken is that the attacker acts as a <em>good engineer</em>, making sure that each tool built will be as much as possible <span id="CTI: Theoretical Elements-How to make intelligence actionable-reusable"></span><strong id="reusable">reusable</strong> and <span id="CTI: Theoretical Elements-How to make intelligence actionable-scalable"></span><strong id="scalable">scalable</strong>.
</p>

<p>
These aspects alone can be used to determine the possible actions preferred by the attacker.
</p>

<div id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain"><h3 id="Intrusion Killchain" class="header"><a href="#CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain">Intrusion Killchain</a></h3></div>

<p>
Like the <a href="Attack Killchain.html">Attack Killchain</a> is used to unroll the phases of an attack, the Intrusion Killchain can be used to represent and analyze tentative of intrusions and extract actionable intelligence. 
</p>

<p>
The main components of the intrusion killchain are the <span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-indicators"></span><strong id="indicators">indicators</strong>, and can be defined as <em>any piece of information that objectively describes an intrusion</em>. Indicators can be classified in three categories: Atomic, Computed and Behavioral.
</p>

<ul>
<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-Atomic"></span><strong id="Atomic">Atomic</strong>. Like an IP address, can't be broken down in smaller parts,

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-Computed"></span><strong id="Computed">Computed</strong>. Are derived from atomic indicators or from data gathered after an incident, for example the MD5 hash of a malware sample.

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-Behavioral"></span><strong id="Behavioral">Behavioral</strong>. As the name suggest they are composed by a set of indicators put together in a human readable way. They are subjected to qualification and combinatorial logic and they represent how the attacker behaves in the system.

</ul>
<p>
Behavioral indicators are far more important because a collection of behavioral indicators represent a subset of the attacker playbook. In general all indicators are pieces of actionable intelligence, but the impact and the usage of different indicators on the analysis are quite different.
</p>

<p>
After an indicator has been identified the analyst have to understand which role played in the attack; atomic indicators can be used to put in place easy countermeasures, and they can be mapped on the intrusion killchain to construct behavioral indicators.
</p>

<p>
The indicators obtained and the intrusion killchain to align defensive capabilities to each specific steps planned by an attacker.
</p>

<p>
<img src="../../wiki/images/theoretical_el_1.png" alt="course of action" />
</p>

<p>
The actions to counteract an intrusion can be classified in six categories:
</p>

<ul>
<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-Detect"></span><strong id="Detect">Detect</strong>

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-Deny"></span><strong id="Deny">Deny</strong>

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-Disrupt"></span><strong id="Disrupt">Disrupt</strong>

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-Degrade"></span><strong id="Degrade">Degrade</strong>

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-Deceive"></span><strong id="Deceive">Deceive</strong>

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Intrusion Killchain-Destroy"></span><strong id="Destroy">Destroy</strong>

</ul>
<p>
Measure effectiveness will drive defensive strategies overtime if there is a clear and organized plan that explain why each countermeasure is used. The whole process must be maintained over time via a good detection engineering process.
</p>

<div id="CTI: Theoretical Elements-How to make intelligence actionable-Pyramid of Pain"><h3 id="Pyramid of Pain" class="header"><a href="#CTI: Theoretical Elements-How to make intelligence actionable-Pyramid of Pain">Pyramid of Pain</a></h3></div>

<p>
Taking into account the assumption of <em>rational human adversary</em> its possible to classify indicators on how costly is for an attacker to change is attack playbook for that indicator to not be present anymore. If an attacker is not willing to invest to change a particular aspect of the attack, the value of the indicator related to that aspect is higher. 
</p>
<ul>
<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Pyramid of Pain-Hash values"></span><strong id="Hash values">Hash values</strong> that can be used to uniquely reference a specific sample of a malware or file involved in an intrusion, can be easily changed by an attacker with code obfuscation or polymorphism.

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Pyramid of Pain-IP Addresses"></span><strong id="IP Addresses">IP Addresses</strong>

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Pyramid of Pain-Domain Names"></span><strong id="Domain Names">Domain Names</strong>

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Pyramid of Pain-Network Artifacts"></span><strong id="Network Artifacts">Network Artifacts</strong>. Assuming that the analyst is able to observe how the malware communicate with a C2 via a specific pattern, the characteristics that compose the pattern can be used to build rules that hugely impact the attackers' strategy. URI Patterns, C2 information embedded in the network protocols, and distinctive HTTP User-Agent are all characteristics that can be mapped to as Network Artifacts.

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Pyramid of Pain-Host Artifacts"></span><strong id="Host Artifacts">Host Artifacts</strong>

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Pyramid of Pain-Tools"></span><strong id="Tools">Tools</strong>

<li>
<span id="CTI: Theoretical Elements-How to make intelligence actionable-Pyramid of Pain-Tactics, Techniques and Procedures"></span><strong id="Tactics, Techniques and Procedures">Tactics, Techniques and Procedures</strong>. TTPs represent the peak of the pyramid, it is the set of actions that the adversary takes to accomplish their mission, from reconnaissance all the way through data exfiltration and at every step in between. 

</ul>
<p>
<img src="../../wiki/images/pyramid_of_pain.png" alt="Pyramid of Pain" />
</p>

<div id="CTI: Theoretical Elements-How to make intelligence actionable-Limits"><h3 id="Limits" class="header"><a href="#CTI: Theoretical Elements-How to make intelligence actionable-Limits">Limits</a></h3></div>

<p>
Using the intrusion killchain and the Pyramid of Pain as a way to map indicators and organize countermeasures has some limits. The main limit is that the limited number of steps is not enough to increase the level of details and to identify gaps, for this reason complementary models can be used to improve the representation have been developed. 
</p>

<div id="CTI: Theoretical Elements-Diamond Model"><h2 id="Diamond Model" class="header"><a href="#CTI: Theoretical Elements-Diamond Model">Diamond Model</a></h2></div>

</body>
</html>
